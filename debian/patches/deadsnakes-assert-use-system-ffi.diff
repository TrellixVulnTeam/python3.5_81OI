From: Felix Krull <f_krull@gmx.de>
Date: Sun, 3 Jul 2016 14:45:11 +0200
Subject: deadsnakes-assert-use-system-ffi

# We always want the system libffi for the Ubuntu package.
---
 setup.py | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/setup.py b/setup.py
index 991369d..18bb8f4 100644
--- a/setup.py
+++ b/setup.py
@@ -2017,6 +2017,10 @@ class PyBuildExt(build_ext):
             ext.libraries.append(ffi_lib)
             self.use_system_libffi = True
 
+        if not self.use_system_libffi:
+            print("Error: not using system libffi", file=sys.stderr)
+            sys.exit(1)
+
     def _decimal_ext(self):
         extra_compile_args = []
         undef_macros = []
